let threatCounts={};chrome.runtime.onMessage.addListener((e,t,s)=>{const n=t.tab.id;if(!n)return;if("threatDetected"===e.action)threatCounts[n]=(threatCounts[n]||0)+1,chrome.action.setBadgeText({text:threatCounts[n].toString(),tabId:n}),chrome.action.setBadgeBackgroundColor({color:"#FF0000",tabId:n});else if("resetThreatCount"===e.action)threatCounts[n]=0,chrome.action.setBadgeText({text:"",tabId:n})});chrome.tabs.onRemoved.addListener(e=>{delete threatCounts[e]});chrome.tabs.onReplaced.addListener((e,t)=>{delete threatCounts[t]});
